<UserControl x:Class="BudgetPlanner.WPF.Views.TransactionForm"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:conv="clr-namespace:BudgetPlanner.WPF.Converters"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"


             mc:Ignorable="d">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="120"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="30"/>
        </Grid.ColumnDefinitions>

        <!-- Rubrik -->
        <TextBlock Grid.Row="0" Grid.ColumnSpan="3" Text="{Binding FormTitle}" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>

        <!-- Datum -->
        <TextBlock Grid.Row="1" Grid.Column="0" Text="Datum:" VerticalAlignment="Center"/>
        <DatePicker Grid.Row="1" Grid.Column="1" SelectedDate="{Binding Form.TransactionDate, Mode=TwoWay}"/>
        <CheckBox Grid.Row="1" Grid.Column="2" IsChecked="{Binding Filter.FilterByDate}"/>

        <!-- Anteckning -->
        <TextBlock Grid.Row="2" Grid.Column="0" Text="Anteckning:" VerticalAlignment="Center"/>
        <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Form.TransactionDescription, Mode=TwoWay}"/>
        <CheckBox Grid.Row="2" Grid.Column="2" IsChecked="{Binding Filter.FilterByDescription}"/>

        <!-- Belopp -->
        <TextBlock Grid.Row="3" Grid.Column="0" Text="Belopp:" VerticalAlignment="Center"/>
        <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding Form.TransactionAmount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnExceptions=True}"/>
        <CheckBox Grid.Row="3" Grid.Column="2" IsChecked="{Binding Filter.FilterByAmount}"/>

        <!-- Kategori -->
        <TextBlock Grid.Row="4" Grid.Column="0" Text="Kategori:" VerticalAlignment="Center"/>
        <ComboBox Grid.Row="4" Grid.Column="1"
                  ItemsSource="{Binding Categories}" 
                  SelectedItem="{Binding Form.TransactionCategory, Mode=TwoWay}"
                  SelectedValuePath="Id"
                  ItemTemplate="{StaticResource CategoryComboBoxItemTemplate}"
                  ItemContainerStyle="{StaticResource CategoryComboBoxItemStyle}"/>
        <CheckBox Grid.Row="4" Grid.Column="2" IsChecked="{Binding Filter.FilterByCategory}"/>

        <!-- Återkommande -->
        <TextBlock Grid.Row="5" Grid.Column="0" Text="Återkommande:" VerticalAlignment="Center"/>
        <ComboBox Grid.Row="5" Grid.Column="1" SelectedItem="{Binding Form.TransactionRecurrence}" ItemsSource="{Binding Form.RecurrenceValues}"/>
        <CheckBox Grid.Row="5" Grid.Column="2" IsChecked="{Binding Filter.FilterByRecurrence}"/>

        <!-- Knappar -->
        <StackPanel Grid.Row="10" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,10,0,0">
            <Button Content="Lägg till" Command="{Binding AddCommand}" Style="{StaticResource EditModeButtonStyle}" Width="80"/>
            <Button Content="Uppdatera" Command="{Binding UpdateCommand}" Style="{StaticResource EditModeVisibleButtonStyle}" Width="80"/>
            <Button Content="Avbryt" Command="{Binding CancelEditCommand}" Style="{StaticResource EditModeVisibleButtonStyle}" Width="80"/>
            <Button Content="Ta bort" Command="{Binding DeleteCommand}" Width="80"
                    IsEnabled="{Binding Selected, Converter={StaticResource NullToBoolConverter}}"/>
        </StackPanel>


            <!-- Brutto / Netto (endast Lön) -->
            <CheckBox Grid.Row="7" Grid.Column="1"
          Content="Beloppet är brutto"
          IsChecked="{Binding Form.IsGrossIncome}"
          Visibility="{Binding Form.ShowIncomeOptions, Converter={StaticResource BoolToVisibilityConverter}}"/>

            <!-- Skattesats -->
            <TextBlock Grid.Row="8" Grid.Column="0"
           Text="Skatt %:"
           Visibility="{Binding Form.ShowIncomeOptions, Converter={StaticResource BoolToVisibilityConverter}}"/>

            <TextBox Grid.Row="8" Grid.Column="1"
         Text="{Binding Form.TaxRate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
         Visibility="{Binding Form.ShowIncomeOptions, Converter={StaticResource BoolToVisibilityConverter}}"/>

    </Grid>
</UserControl>
